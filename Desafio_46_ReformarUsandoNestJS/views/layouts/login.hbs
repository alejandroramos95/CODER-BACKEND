<html lang='en'>
    <head>
        <meta charset='UTF-8' />
        <meta http-equiv='X-UA-Compatible' content='IE=edge' />
        <meta name='viewport' content='width=device-width, initial-scale=1.0' />
        <!-- Font Awesome -->
        <link
            href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css'
            rel='stylesheet'
        />
        <!-- Google Fonts -->
        <link
            href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap'
            rel='stylesheet'
        />
        <!-- MDB -->
        <link
            href='https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.1.0/mdb.min.css'
            rel='stylesheet'
        />
        <!-- MDB -->
        <script
            type='text/javascript'
            src='https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.1.0/mdb.min.js'
        ></script>
        <title>Login</title>
    </head>
    <body>
        <style>
            .gradient-custom {
/* fallback for old browsers */
background: #6a11cb;

/* Chrome 10-25, Safari 5.1-6 */
background: -webkit-linear-gradient(to right, rgba(106, 17, 203, 1), rgba(37, 117, 252, 1));

/* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
background: linear-gradient(to right, rgba(106, 17, 203, 1), rgba(37, 117, 252, 1))
}
        </style>
        <section class='vh-100 gradient-custom'>
            <div class='container py-5 h-100'>
                <div
                    class='row d-flex justify-content-center align-items-center h-100'
                >
                    <div class='col-12 col-md-8 col-lg-6 col-xl-5'>
                        <div
                            class='card bg-dark text-white'
                            style='border-radius: 1rem;'
                        >
                            <div class='card-body p-5 text-center'>

                                <div class='mb-md-5 mt-md-4 pb-5'>

                                    <h2
                                        class='fw-bold mb-2 text-uppercase'
                                    >Login</h2>
                                    <p class='text-white-50 mb-5'>¡Por favor ingrese sus credenciales!</p>
                                    
                                    <form id="myForm" name="myForm" method="POST">
                                        <div class='form-outline form-white mb-4'>
                                            <input
                                                type='email'
                                                id='email'
                                                class='form-control form-control-lg'
                                                name="email"
                                            />
                                            <label
                                                class='form-label'
                                                for='email'
                                            >Email</label>
                                        </div>

                                        <div class='form-outline form-white mb-4'>
                                            <input
                                                type='password'
                                                id='password'
                                                class='form-control form-control-lg'
                                                name="password"
                                            />
                                            <label
                                                class='form-label'
                                                for='password'
                                            >Password</label>
                                        </div>

                                        <p class='small mb-5 pb-lg-2'><a
                                                class='text-white-50'
                                                href='#!'
                                            >Forgot password?</a></p>

                                        <button
                                            class='btn btn-outline-light btn-lg px-5'
                                            type='button'
                                            onclick="validateForm()"
                                        >Login</button>

                                        <div
                                            class='d-flex justify-content-center text-center mt-4 pt-1'
                                        >
                                            <a href='#!' class='text-white'><i
                                                    class='fab fa-facebook-f fa-lg'
                                                ></i></a>
                                            <a href='#!' class='text-white'><i
                                                    class='fab fa-twitter fa-lg mx-4 px-2'
                                                ></i></a>
                                            <a href='#!' class='text-white'><i
                                                    class='fab fa-google fa-lg'
                                                ></i></a>
                                        </div>
                                    </form>
                                </div>

                                <div>
                                    <p class='mb-0'>Don't have an account?
                                        <a
                                            href='/register'
                                            class='text-white-50 fw-bold'
                                        >Sign Up</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <script>
            async function validateForm(){
                const password = document.forms["myForm"]["password"].value;
                const confirmPassword = document.forms["myForm"]["email"].value;
                if (password.trim() < 1) {
                    return alert("La contraseña no puede estar vacia.");
                } else if (confirmPassword.trim() < 1) {
                    return alert("El email no puede estar vacio.");
                }
                //values of the form to json
                const form = document.getElementById('myForm');
                const data = new FormData(form);
                const value = Object.fromEntries(data.entries());
                return sendForm(value);
            }

            const sendForm = async(form) => {
                const response = await fetch('/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(form)
                });
                if(await response.status == 201){
                    return window.location.href = '/';
                } else if(await response.status == 401) {
                    return alert("Credenciales incorrectas.");
                }else{
                    return alert("Error al intentar inciar sesión.");
                }
            }
        </script>
    </body>
</html>